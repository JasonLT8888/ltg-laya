!function(t){var e={};function a(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=t,a.c=e,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(s,r,function(e){return t[e]}.bind(null,r));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s="./src/main.ts")}({"./src/LTGame/Commom/CommonEventId.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"CommonEventId",function(){return s});class s{}s.PAUSE_AUDIO="PAUSE_AUDIO",s.RESUM_AUDIO="RESUM_AUDIO",s.AD_CONFIG_GETTED="AD_CONFIG_GETTED"},"./src/LTGame/Config/ConfigManager.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"ConfigManager",function(){return s});class s{static get needLoadCount(){return this._configList.length}static AddConfig(t){s._configList.push(t)}static StartLoad(t,e=null){if(0!=s._configList.length){var a=[];for(let t of s._configList)a.push(t.path);Laya.loader.create(a,Laya.Handler.create(this,()=>{for(let t of s._configList){t.data=Laya.loader.getRes(t.path),t.dataList=[];for(let e in t.data){let a=t.data[e];null!=a&&t.dataList.push(a)}}t&&t.run()}),e)}else t&&t.run()}}s._configList=[]},"./src/LTGame/Config/LoadPackConfig.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"LoadPackConfig",function(){return s}),a.d(e,"EPackType",function(){return r});class s{constructor(t,e){this.path=t,this.pathType=e}}var r;!function(t){t[t.MainPack=1]="MainPack",t[t.SubPack=2]="SubPack",t[t.Remote=3]="Remote"}(r||(r={}))},"./src/LTGame/Fsm/BaseState.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{constructor(t){this.id=t}GetNextState(){return this.isFinished?this.nextState:0}OnEnter(t,e){this.isFinished=!1,this.nextState=0,this.passTime=0,this.deltaTime=0,this._DoEnter(t,e)}OnRunning(t,e){this.isFinished||(this.deltaTime=e,this.passTime+=e,this._DoRunning(t))}OnExit(t,e){this._DoExit(t,e)}OnLateUpdate(t){this.isFinished||this._DoLateUpdate(t)}_DoLateUpdate(t){}_DoEnter(t,e){}_DoRunning(t){}_DoExit(t,e){}}},"./src/LTGame/Fsm/StateMachine.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return r});var s=a("./src/LTGame/LTUtils/LTDictionary.ts");class r{constructor(){this._states=new s.default}get count(){return this._states.count}Add(t){return this._states.Add(t.id,t)}Remove(t){return this._states.Remove(t)}RemoveAll(){this._states.Clear(),this.currState=null}ExitCurrState(t=null){null!=this.currState&&(this.currState.OnExit(null,t),this.currState=null)}ChangeState(t,e=null){var a=this.Find(t);return null!=a?(null!=this.currState&&this.currState.OnExit(a,e),this.lastState=this.currState,this.currState=a,a.OnEnter(this.lastState,e),!0):(console.error("不存在的状态ID:"+t),!1)}OnRunning(t,e){null!=this.currState&&this.currState.OnRunning(t,e)}Find(t){return this._states.Get(t)}}},"./src/LTGame/LTUtils/ColorEx.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{static RgbToHex(t,e,a){for(var s=(t<<16|e<<8|a).toString(16);s.length<6;)s="0"+s;return"#"+s}static ColorToHex(t){return this.RgbToHex(255*t.r,255*t.g,255*t.b)}static HexToColor(t,e=null){let a=t.substring(0,2),s=t.substring(2,4),r=t.substring(4,6),i=t.substring(6,8),n=parseInt(a,16),o=parseInt(s,16),l=parseInt(r,16),c=e||parseInt(i,16);return new Laya.Color(n/255,o/255,l/255,c)}static ToV3(t){return new Laya.Vector3(t.r,t.g,t.b)}static ToV4(t){return new Laya.Vector4(t.r,t.g,t.b,t.a)}static _Hex(t){return("0"+t.toString(16)).slice(-2)}}},"./src/LTGame/LTUtils/LTDictionary.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{constructor(){this._values=[],this._keys=[]}get values(){return this._values}get keys(){return this._keys}get count(){return this._keys.length}set(t,e){var a=this.indexOf(t);a>=0?this._values[a]=e:(this._keys.push(t),this._values.push(e))}indexOf(t){var e=this._keys.indexOf(t);return e>=0?e:-1}Get(t){var e=this.indexOf(t);return e<0?null:this._values[e]}ContainsKey(t){return this.indexOf(t)>=0}Add(t,e){return!(this.indexOf(t)>=0)&&(this._keys.push(t),this._values.push(e),!0)}Remove(t){var e=this.indexOf(t);return e>=0&&(this._keys.splice(e,1),this._values.splice(e,1),!0)}Clear(){this._values.length=0,this._keys.length=0}}},"./src/LTGame/LTUtils/LTUtils.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"LTUtils",function(){return s});class s{static CachFile(t){if(Laya.Browser.onWeiXin){var e=Laya.URL.formatURL(t);null==Laya.MiniAdpter.getFileInfo(e)&&Laya.MiniAdpter.downLoadFile(e)}}static DownLoadFiles(t,e,a){Laya.loader.create(t,e,a,null,null,null,1,!0)}static SetShadow(t,e,a){let s=t.meshRenderer;if(null!=s)return s.castShadow=e,s.receiveShadow=a,t;let r=t.skinnedMeshRenderer;return null!=r?(r.castShadow=e,r.receiveShadow=a,t):t}static EnableShadow(t,e){t.shadow=!0,t.shadowDistance=e,t.shadowResolution=1024,t.shadowPSSMCount=1,t.shadowPCFType=3}static GetRes(t,e=!1){var a=Laya.loader.getRes(t);return null==a?(console.error("资源尚未加载",t),null):e?a:a.clone()}static FindChild(t,e){if(""==e)return t;var a=e.split("/");return s._FindChild(a,t,0)}static _FindChild(t,e,a){var r=e.getChildByName(t[a]);return null==r?(console.log(e,"下不存在节点:",t[a]),null):a+1==t.length?r:s._FindChild(t,r,a+1)}static GetCoinStr(t){if(null==this._strMap){this._strMap=["","K","M","B","T","Q"];for(let t=0;t<500;++t){let e=String.fromCharCode(Math.floor(t/24)+97),a=String.fromCharCode(Math.floor(t%24)+97);this._strMap.push(e+a)}}let e=0;for(;t>1e3;)t/=1e3,e++;return e>=this._strMap.length?(console.error("单位表越界"),t.toFixed(1)+"aa"):e<=0?t.toFixed(0):t.toFixed(1)+this._strMap[e]}static GetCoinStr1(t){if(null==this._strMap){this._strMap=["","K","M","B","T","Q"];for(let t=0;t<500;++t){let e=String.fromCharCode(Math.floor(t/24)+97),a=String.fromCharCode(Math.floor(t%24)+97);this._strMap.push(e+a)}}let e=0;for(;t>1e3;)t/=1e3,e++;return e>=this._strMap.length?(console.error("单位表越界"),t.toFixed(1)+"aa"):e<=0?t.toFixed(0):t.toFixed(0)+this._strMap[e]}static makeTimeLeftString(t,e=":",a=!1){var r,i="";if(t<=0)return i+="00:00";if(t>s.ONE_YEAR)return i="大于一年";if(a){var n;if(t>s.ONE_DAY)i=(n=Math.floor(t/s.ONE_DAY))+"天";else if(t>=3600)i=(r=Math.floor(t/3600))+"时";else{var o,l;(o=Math.floor(t/60))<10&&(i+="0"),i+=o.toString()+e,(l=t%60)<10&&(i+="0"),i+=l.toString()}return i}if(t>s.ONE_DAY&&(i=(n=Math.floor(t/s.ONE_DAY))+"天",t-=n*s.ONE_DAY,a))return(r=Math.floor(t/3600))>0&&(i+=r+"时"),i;return t<=0?i+="00:00":(i="",(r=Math.floor(t/3600))>0&&(i+=r<10?"0"+r.toString()+e:r.toString()+e),(o=Math.floor((t-3600*r)/60))>0||r>0?(o<10&&(i+="0"),i+=o.toString()+e):i+="00"+e,(l=t%60)<10&&(i+="0"),i+=l.toString())}static GetCurrentDayCount(t){return Math.floor(t/1e3/60/60/24)}}s.ONE_YEAR=31536e3,s.ONE_DAY=86400},"./src/LTGame/LTUtils/MathEx.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{static ToHex(t){return t.toString(16)}static RandomFromArray(t){return t[s.RandomInt(0,t.length)]}static RandomFromWithWeight(t,e){if(null==t||0==t.length)return null;var a=0;for(var r of e)a+=r;for(var i=s.Random(0,a),n=0,o=0;o<t.length;++o)if(i<(n+=e[o]))return t[o];return t[t.length-1]}static RandomInt(t,e){return Math.floor(this.Random(t,e))}static Random(t,e){return(e-t)*Math.random()+t}static Clamp(t,e,a){return t<e?e:t>a?a:t}static Clamp01(t){return this.Clamp(t,0,1)}static Sign(t){return 0==t?1:t>0?1:-1}static GetNumCount(t){for(var e=0,a=t;a/10>0;)a=Math.floor(a/10),e++;return e}static Lerp(t,e,a){return t+(e-t)*a}static MoveTowardsAngle(t,e,a){var r=s.DeltaAngle(t,e);return 0-a<r&&r<a?e:(e=t+r,s.MoveTowards(t,e,a))}static MoveTowards(t,e,a){return Math.abs(e-t)<=a?e:t+Math.sign(e-t)*a}static DeltaAngle(t,e){var a=s.Repeat(e-t,360);return a>180&&(a-=360),a}static Repeat(t,e){return s.Clamp(t-Math.floor(t/e)*e,0,e)}static IsSimilar(t,e){return t==e}}s.Deg2Rad=.0175,s.Rad2Deg=57.2958},"./src/LTGame/LTUtils/MonoHelper.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s}),a.d(e,"EActionType",function(){return r});class s extends Laya.Script{constructor(){super(...arguments),this._updateActions=[],this._lateUpdateActions=[]}static get instance(){if(null==this._instance){let t=new Laya.Sprite;this._instance=t.addComponent(s),Laya.stage.addChild(t)}return this._instance}_GetActionList(t){switch(t){case r.Update:return this._updateActions;case r.LateUpdate:return this._lateUpdateActions;default:return console.error("未处理的actionType类型",t),null}}AddAction(t,e,a,s){let r=this._GetActionList(t);if(null==r)return;for(let t=0;t<r.length;++t){let s=r[t];if(s.caller==e&&s.method==a)return void console.warn("已存在重复注册事件,取消注册")}let i=Laya.Handler.create(e,a,s,!1);r.push(i)}RemoveAction(t,e,a){let s=this._GetActionList(t);if(null!=s)for(let t=0;t<s.length;++t){let r=s[t];if(r.caller==e&&r.method==a)return void(s=s.splice(t,1))}}onUpdate(){for(let t=0;t<this._updateActions.length;++t){this._updateActions[t].run()}}onLateUpdate(){for(let t=0;t<this._lateUpdateActions.length;++t){this._lateUpdateActions[t].run()}}onDestroy(){s._instance=null}}var r;!function(t){t[t.Update=0]="Update",t[t.LateUpdate=1]="LateUpdate"}(r||(r={}))},"./src/LTGame/LTUtils/StringEx.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{static SplitToIntArray(t,e){for(var a=t.split(e),s=[],r=0;r<a.length;++r){var i=parseInt(a[r]);isNaN(i)&&(i=0),s.push(i)}return s}static IntArrToStr(t){for(var e="",a=0;a<t.length;++a)e+=t[a].toFixed(0),a<t.length-1&&(e+=",");return e}static IsNullOrEmpty(t){return null==t||""==t}}},"./src/LTGame/LTVersion.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{}s.version="0.0.1"},"./src/LTGame/Platform/BDPlatform.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return o});var s=a("./src/LTGame/Platform/WXPlatform.ts"),r=a("./src/LTGame/Platform/EPlatformType.ts"),i=a("./src/LTGame/LTUtils/StringEx.ts"),n=a("./src/LTGame/Commom/CommonEventId.ts");class o extends s.default{constructor(){super(...arguments),this.platform=r.EPlatformType.BD,this._showVideoLoad=!1}Init(t){this._base=window.swan,null!=this._base?(this._platformData=t,this._InitLauchOption(),this._InitShareInfo(),this._InitSystemInfo(),this._isBannerLoaded=!1,this._isBannerShowed=!1,this._CreateVideoAd(),this._CreateInterstitalAd(),window.iplatform=this):console.error("平台初始化错误")}_CreateBannerAd(){if(i.default.IsNullOrEmpty(this._platformData.bannerId))return void console.log("无有效的banner广告ID,取消加载");let t=this._base.getSystemInfoSync().windowWidth,e=this._base.getSystemInfoSync().windowHeight,a={};a.adUnitId=this._platformData.bannerId,a.appSid=this.sid;let s={left:0,top:0};s.width=t,a.style=s,this._bannerAd=this._base.createBannerAd(a),this._bannerAd.onLoad(()=>{console.log("banner加载成功"),this._isBannerLoaded=!0,this._bannerAd.style.top=e-this._bannerAd.style.height,this._bannerAd.show()}),this._bannerAd.onError(t=>{console.error("banner广告加载失败",t)})}_CreateVideoAd(){if(i.default.IsNullOrEmpty(this._platformData.rewardVideoId))return void console.log("无有效的视频广告ID,取消加载");this._videoFailedCount=0;let t={};t.adUnitId=this._platformData.rewardVideoId,t.appSid=this.sid,this._rewardVideo=this._base.createRewardedVideoAd(t),this._rewardVideo.onLoad(()=>{console.log("视频广告加载成功"),this._isVideoLoaded=!0}),this._rewardVideo.onError(t=>{this._videoFailedCount++,console.error("视频广告加载失败",t),this._videoFailedCount>10&&(console.log("第",this._videoFailedCount,"次重新加载视频广告"),this._rewardVideo.load())}),this._rewardVideo.onClose(t=>{this._base.hideLoading(),Laya.stage.event(n.CommonEventId.RESUM_AUDIO),console.log("视频回调",t),t.isEnded?this._rewardSuccessed&&this._rewardSuccessed.run():this._rewardSkipped&&this._rewardSkipped.run(),this._rewardVideo.load()})}_CreateInterstitalAd(){}LoadSubpackage(t,e,a,s){let r={};r.name=t,r.success=(()=>{console.log("分包加载成功",t),e&&e.run()}),r.fail=(()=>{console.error("分包加载失败",t),a&&a.run()}),this._base.loadSubpackage(r).onProgressUpdate(t=>{if(s){let e=t.progress/100;isNaN(e)&&(e=t.loaded/t.total),s.runWith(e)}})}RecordEvent(t,e){this._base.reportAnalytics(t,e)}ShowBannerAd(){this._isBannerLoaded||this._CreateBannerAd()}HideBannerAd(){this._isBannerLoaded&&(this._isBannerLoaded=!1,this._bannerAd&&this._bannerAd.destroy())}}},"./src/LTGame/Platform/Data/LTPlatformData.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{constructor(){this.bannerId="",this.rewardVideoId="",this.interstitialId=""}}},"./src/LTGame/Platform/DefaultPlatform.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return i});var s=a("./src/LTGame/Platform/EPlatformType.ts"),r=a("./src/LTGame/Platform/LTPlatform.ts");class i{constructor(){this.platform=s.EPlatformType.Web,this.safeArea=null}Init(t){this.loginState={isLogin:!1,code:null},Laya.timer.once(500,this,this._FakeLoginEnd)}_FakeLoginEnd(){this.onLoginEnd&&this.onLoginEnd.run()}IsBannerAvaliable(){return!1}IsVideoAvaliable(){return!0}IsInterstitalAvaliable(){return!1}ShowBannerAd(){console.log("调用ShowBannerAd")}HideBannerAd(){console.log("调用HideBannerAd")}ShowRewardVideoAd(t,e){console.log("调用ShowRewardVideoAd"),null!=t&&t.run()}ShowInterstitalAd(){console.log("调用ShowInterstitalAd")}GetFromAppId(){return null}ShareAppMessage(t,e=null,a=null){console.log("分享消息",t),e&&e.run()}LoadSubpackage(t,e,a){e&&e.run()}RecordEvent(t,e){console.log("记录事件",t,e)}StartRecord(t){console.log(r.default.platformStr,"暂未实现录屏功能")}StopRecord(){console.log(r.default.platformStr,"暂未实现录屏功能")}ShareVideoInfo(){console.log(r.default.platformStr,"暂未实现录屏功能")}_CheckUpdate(){}ShowToast(t){console.log("提示信息:",t)}}},"./src/LTGame/Platform/EPlatformType.ts":function(t,e,a){"use strict";var s;a.r(e),a.d(e,"EPlatformType",function(){return s}),function(t){t[t.None=0]="None",t[t.Web=1]="Web",t[t.WX=2]="WX",t[t.QQ=3]="QQ",t[t.BD=4]="BD",t[t.Oppo=5]="Oppo",t[t.Vivo=6]="Vivo",t[t.TT=7]="TT",t[t.QTT=8]="QTT"}(s||(s={}))},"./src/LTGame/Platform/LTPlatform.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return i});var s=a("./src/LTGame/Platform/EPlatformType.ts"),r=a("./src/LTGame/Platform/LTPlatformFactory.ts");class i{static get instance(){return null==this._instance&&console.error("对象尚未初始化,请先调用CreateInstance进行初始化"),this._instance}static CreateInstance(t=null){return null!=this._instance?(console.error("已调用过平台创建为",i.GetPlatformStr(this._instance.platform),"不能重复创建"),this._instance):(this._instance=r.default.CreateInstance(),this._instance.appId=t,console.log("平台实例创建完成",i.GetPlatformStr(this._instance.platform)),this._instance)}static get platformStr(){return i.GetPlatformStr(this._instance.platform)}static GetPlatformStr(t){switch(t){case s.EPlatformType.BD:return"百度";case s.EPlatformType.None:return"未识别";case s.EPlatformType.Oppo:return"Oppo";case s.EPlatformType.QQ:return"QQ";case s.EPlatformType.TT:return"头条";case s.EPlatformType.Vivo:return"Vivo";case s.EPlatformType.Web:return"网页";case s.EPlatformType.WX:return"微信";case s.EPlatformType.QTT:return"趣头条";default:return"未定义"}}}},"./src/LTGame/Platform/LTPlatformFactory.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return c});var s=a("./src/LTGame/Platform/TTPlatform.ts"),r=a("./src/LTGame/Platform/WXPlatform.ts"),i=a("./src/LTGame/Platform/BDPlatform.ts"),n=a("./src/LTGame/Platform/QTTPlatform.ts"),o=a("./src/LTGame/Platform/QQPlatform.ts"),l=a("./src/LTGame/Platform/DefaultPlatform.ts");class c{static CreateInstance(){let t,e=null!=window.qttGame;return null!=window.tt?t=new s.default:Laya.Browser.onMiniGame?t=new r.default:Laya.Browser.onBDMiniGame?t=new i.default:e?t=new n.default:Laya.Browser.onQQMiniGame?t=new o.default:(console.log("未识别平台,默认创建为web",Laya.Browser.userAgent),t=new l.default),t}}},"./src/LTGame/Platform/QQPlatform.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return o});var s=a("./src/LTGame/Platform/WXPlatform.ts"),r=a("./src/LTGame/Platform/EPlatformType.ts"),i=a("./src/LTGame/Platform/LTPlatform.ts"),n=a("./src/LTGame/LTUtils/StringEx.ts");class o extends s.default{constructor(){super(...arguments),this.platform=r.EPlatformType.QQ}Init(t){this._base=window.qq,null!=this._base?(this._platformData=t,this._InitLauchOption(),this._Login(),this._InitShareInfo(),this._InitSystemInfo(),this._CreateBannerAd(),this._CreateVideoAd(),this._CreateInterstitalAd(),window.iplatform=this):console.error("平台初始化错误",i.default.platformStr)}_InitSystemInfo(){try{let t=this._base.getSystemInfoSync();this._cacheScreenScale=t.screenWidth/Laya.stage.width,this.safeArea={},this.safeArea.width=t.windowWidth,this.safeArea.height=t.windowHeight,this.safeArea.top=t.statusBarHeight,this.safeArea.bottom=0,console.log("QQ覆写_InitSystemInfo",this.safeArea)}catch(t){console.error(t),console.error("获取设备信息失败,执行默认初始化"),this.safeArea=null}}_CreateBannerAd(){if(n.default.IsNullOrEmpty(this._platformData.bannerId))return void console.log("无有效的banner广告ID,取消加载");let t=this._base.getSystemInfoSync().windowWidth,e=this._base.getSystemInfoSync().windowHeight,a={};a.adUnitId=this._platformData.bannerId;let s={left:0,top:0,width:300};a.style=s,this._bannerAd=this._base.createBannerAd(a),this._isBannerLoaded=!1,this._bannerAd.onLoad(()=>{console.log("banner加载成功",this._bannerAd),this._isBannerLoaded=!0}),this._bannerAd.onError(t=>{console.error("banner广告加载失败",t)}),this._bannerAd.onResize(a=>{console.log("onResize"),this._bannerAd.style.top=e-a.height,this._bannerAd.style.left=(t-a.width)/2})}}},"./src/LTGame/Platform/QTTPlatform.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return n});var s=a("./src/LTGame/Platform/WXPlatform.ts"),r=a("./src/LTGame/Platform/EPlatformType.ts"),i=a("./src/LTGame/Commom/CommonEventId.ts");class n extends s.default{constructor(){super(...arguments),this.platform=r.EPlatformType.QTT}Init(t){this._base=window.qttGame,null!=this._base?(this._platformData=t,window.iplatform=this):console.error("平台初始化错误")}IsBannerAvaliable(){return!0}ShowBannerAd(){this._base.showBanner({index:1})}HideBannerAd(){this._base.hideBanner()}IsVideoAvaliable(){return!0}ShowRewardVideoAd(t,e){let a={index:1,gametype:1,rewardtype:1,data:{}};a.data.title="获得奖励",Laya.stage.event(i.CommonEventId.PAUSE_AUDIO),this._base.showVideo(a=>{Laya.stage.event(i.CommonEventId.RESUM_AUDIO),1==a?t&&t.run():e&&e.run()},a)}ShowInterstitalAd(){this.ShowHDReward()}ShowHDReward(){let t={index:1,rewardtype:1};this._base.showHDReward(t)}RecordEvent(t,e){console.log("记录事件",t,e)}}},"./src/LTGame/Platform/ShareInfo.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"ShareInfo",function(){return s});class s{}},"./src/LTGame/Platform/ShareManager.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return n});var s=a("./src/LTGame/LTUtils/MathEx.ts"),r=a("./src/LTGame/Platform/LTPlatform.ts"),i=a("./src/LTGame/Platform/ShareInfo.ts");class n{constructor(){this._shareInfoList=[]}static get instance(){return null==this._instance&&(this._instance=new n),this._instance}AddShareInfo(t){for(let e of this._shareInfoList)if(e.shareId==t.shareId)return;this._shareInfoList.push(t)}GetShareInfo(t=null){if(0==this._shareInfoList.length){return new i.ShareInfo}if(null!=t)for(let e of this._shareInfoList)if(e.shareId==t)return e;return s.default.RandomFromArray(this._shareInfoList)}ShareAppMessage(t){r.default.instance.ShareAppMessage(t,Laya.Handler.create(this,()=>{console.log("分享成功")}),null)}}},"./src/LTGame/Platform/TTPlatform.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return c});var s=a("./src/LTGame/Platform/WXPlatform.ts"),r=a("./src/LTGame/Platform/EPlatformType.ts"),i=a("./src/LTGame/LTUtils/MathEx.ts"),n=a("./src/LTGame/Platform/LTPlatform.ts"),o=a("./src/LTGame/Platform/ShareManager.ts"),l=a("./src/LTGame/LTUtils/StringEx.ts");class c extends s.default{constructor(){super(...arguments),this.platform=r.EPlatformType.TT,this._showVideoLoad=!1}Init(t){this._base=window.tt,null!=this._base?(this._platformData=t,this._InitLauchOption(),this._InitShareInfo(),this._InitSystemInfo(),this._CreateBannerAd(),this._CreateVideoAd(),this._CreateInterstitalAd(),this._CreateRecordManager(),window.iplatform=this):console.error("平台初始化错误")}_CreateBannerAd(){if(l.default.IsNullOrEmpty(this._platformData.bannerId))return void console.log("无有效的banner广告ID,取消加载");let t=this._base.getSystemInfoSync().windowWidth,e=this._base.getSystemInfoSync().windowHeight,a={};a.adUnitId=this._platformData.bannerId,a.adIntervals=30;let s={left:0,top:0};s.width=t,a.style=s,this._bannerAd=this._base.createBannerAd(a),this._isBannerLoaded=!1,this._bannerAd.onLoad(()=>{console.log("banner加载成功",this._bannerAd),this._isBannerLoaded=!0}),this._bannerAd.onError(t=>{console.error("banner广告加载失败",t),this._bannerAd}),this._bannerAd.onResize(a=>{this._bannerAd.style.top=e-a.height,this._bannerAd.style.left=(t-a.width)/2})}_CreateRecordManager(){this._isRecording=!1,this._isRecordSuccess=!1,this._recorderManager=this._base.getGameRecorderManager(),this._recorderManager.onStart(t=>{console.log("开始录制",t),this._isRecording=!0,this._isRecordSuccess=!1,this._startCallBack&&this._startCallBack.run(),this._startCallBack=null}),this._recorderManager.onStop(t=>{console.log("停止录制",t),this._cacheRecorderVideoPath=t.videoPath,this._isRecording=!1,this._isRecordSuccess=!0,this._endCallBack&&this._endCallBack.run(),this._endCallBack=null}),this._recorderManager.onError(t=>{console.log("录制发生错误",t),this._isRecordSuccess=!1})}RecordEvent(t,e){let a=this._base.reportAnalytics;a?(null==e&&(e={}),a(t,e)):console.error("reportAnalytics 方法不存在")}ShowBannerAd(){this.IsBannerAvaliable()&&this._bannerAd.show()}StartRecord(t,e,a){this._isRecording?console.log("视频已经在录制中,不能重复录制"):(console.log("调用开始录屏"),t=i.default.Clamp(t,3,300),this._recorderManager.start({duration:t}),this._startCallBack&&(this._startCallBack.recover(),this._startCallBack=null),this._startCallBack=e,this._endCallBack&&(this._endCallBack.recover(),this._endCallBack=null),this._endCallBack=a)}StopRecord(){this._isRecording?(console.log("调用停止录屏"),this._recorderManager.stop()):console.log("没有视频正在录制中,无法停止录制")}ShareVideoInfo(t,e){if(this._isRecordSuccess){let a={channel:"video"},s=o.default.instance.GetShareInfo();a.title=s.shareTitle,a.extra={videoPath:this._cacheRecorderVideoPath},a.success=(()=>{console.log("分享成功"),t&&t.run()}),a.fail=(t=>{console.log("分享失败",t),e&&e.run()}),this._base.shareAppMessage(a)}else console.log(n.default.platformStr,"录屏发生错误,无法分享")}ShareAppMessage(t,e,a){console.log("分享消息",t);let r=s.default._WrapShareInfo(t);r.success=(()=>{console.log("分享成功"),e&&e.run()}),r.fail=(()=>{console.log("分享失败"),a&&a.run()}),this._base.shareAppMessage(r)}}},"./src/LTGame/Platform/WXPlatform.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return c});var s=a("./src/LTGame/LTUtils/StringEx.ts"),r=a("./src/LTGame/Platform/EPlatformType.ts"),i=a("./src/LTGame/Platform/ShareManager.ts"),n=a("./src/LTGame/Platform/LTPlatform.ts"),o=a("./src/LTGame/LTUtils/MathEx.ts"),l=a("./src/LTGame/Commom/CommonEventId.ts");class c{constructor(){this.platform=r.EPlatformType.WX,this.safeArea=null,this._isBannerLoaded=!1,this._isVideoLoaded=!1,this._isInterstitialLoaded=!1,this._showVideoLoad=!0}Init(t){this._base=window.wx,null!=this._base?(this._platformData=t,this._InitLauchOption(),this._Login(),this._InitShareInfo(),this._InitSystemInfo(),this._CreateBannerAd(),this._CreateVideoAd(),this._CreateInterstitalAd(),window.iplatform=this):console.error("平台初始化错误",n.default.platformStr)}_CheckUpdate(){let t=this._base.getUpdateManager();null!=t&&(t.onCheckForUpdate(function(t){console.log("onCheckForUpdate",t.hasUpdate),t.hasUpdate&&this._base.showToast({title:"即将有更新请留意"})}),t.onUpdateReady(()=>{this._base.showModal({title:"更新提示",content:"新版本已经准备好，是否立即使用？",success:function(e){e.confirm?t.applyUpdate():this._base.showToast({icon:"none",title:"小程序下一次「冷启动」时会使用新版本"})}})}),t.onUpdateFailed(()=>{this._base.showToast({title:"更新失败，下次启动继续..."})}))}_CreateRecordManager(){this._isRecording=!1,this._isRecordSuccess=!1,this._recorderManager=this._base.getGameRecorder(),this._recorderManager.on("start",()=>{console.log("开始录制"),this._isRecording=!0,this._isRecordSuccess=!1}),this._recorderManager.on("stop",t=>{console.log("停止录制",t),this._cacheRecorderVideoPath=t.videoPath,this._isRecording=!1,this._isRecordSuccess=!0}),this._recorderManager.on("error",t=>{console.log("录制发生错误",t),this._isRecordSuccess=!1})}_Login(){this.loginState={isLogin:!1,code:""};let t={};t.success=(t=>{this._OnLoginSuccess(t)}),t.fail=(t=>{console.error(n.default.platformStr,"登录失败",t),this.loginState.isLogin=!1,this.loginState.code=""}),t.complete=(t=>{null!=this.onLoginEnd&&this.onLoginEnd.run()}),this._base.login(t)}_OnLoginSuccess(t){console.log(n.default.platformStr,"登录成功",t),this.loginState.isLogin=!0,this.loginState.code=t.code}_InitLauchOption(){this._base.onShow(this._OnShow),this._base.onHide(this._OnHide);let t=this._base.getLaunchOptionsSync();this._OnShow(t)}_InitShareInfo(){this._base.showShareMenu({withShareTicket:!0,success:t=>{console.log("InitShareSuccess",t)},fail:t=>{console.log("InitShareFailed",t)},complete:t=>{console.log("InitShareComplete",t)}}),this._base.onShareAppMessage(()=>{let t=i.default.instance.GetShareInfo();return c._WrapShareInfo(t)})}static _WrapShareInfo(t){let e={};if(t.shareTitle&&(e.title=t.shareTitle),t.shareImg&&(e.imageUrl=t.shareImg),t.sharePath){e.query={};let a=t.sharePath.split("?")[1].split("&");for(let t of a){let a=t.split("=");e.query[a[0]]=a[1]}}return e}_InitSystemInfo(){try{let t=this._base.getSystemInfoSync();this.safeArea=t.safeArea,this._cacheScreenScale=t.screenWidth/Laya.stage.width}catch(t){console.error(t),console.error("获取设备信息失败,执行默认初始化"),this.safeArea=null}}_CreateInterstitalAd(){if(s.default.IsNullOrEmpty(this._platformData.interstitialId))return void console.log("无有效的插页广告ID,取消加载");this._interstitalFailedCount=0;let t={};t.adUnitId=this._platformData.interstitialId,this._intersitialAd=this._base.createInterstitialAd(t),this._intersitialAd.onLoad(()=>{console.log("插页广告加载成功"),this._isInterstitialLoaded=!0}),this._intersitialAd.onError(t=>{this._interstitalFailedCount++,console.error("插页广告加载失败",t),this._interstitalFailedCount>10&&(console.log("第",this._interstitalFailedCount,"次重新加载插页广告"),this._intersitialAd.load())})}_CreateVideoAd(){let t=this._base.createRewardedVideoAd;if(null==t)return void console.error("无createRewardedVideoAd方法,跳过初始化");if(s.default.IsNullOrEmpty(this._platformData.rewardVideoId))return void console.log("无有效的视频广告ID,取消加载");this._videoFailedCount=0;let e={};e.adUnitId=this._platformData.rewardVideoId,this._rewardVideo=t(e),this._rewardVideo.onLoad(()=>{console.log("视频广告加载成功"),this._isVideoLoaded=!0}),this._rewardVideo.onError(t=>{this._videoFailedCount++,console.error("视频广告加载失败",t),this._videoFailedCount>10&&(console.log("第",this._videoFailedCount,"次重新加载视频广告"),this._rewardVideo.load())}),this._rewardVideo.onClose(t=>{Laya.stage.event(l.CommonEventId.RESUM_AUDIO),console.log("视频回调",t),t.isEnded?this._rewardSuccessed&&this._rewardSuccessed.run():(this._rewardSkipped&&this._rewardSkipped.run(),this.ShowToast("跳过视频无法获得奖励"))})}_CreateBannerAd(){if(s.default.IsNullOrEmpty(this._platformData.bannerId))return void console.log("无有效的banner广告ID,取消加载");let t=this._base.getSystemInfoSync().windowWidth,e=this._base.getSystemInfoSync().windowHeight,a={};a.adUnitId=this._platformData.bannerId,a.adIntervals=30;let r={left:0,top:0,width:300};a.style=r,this._bannerAd=this._base.createBannerAd(a),this._isBannerLoaded=!1,this._bannerAd.onLoad(()=>{console.log("banner加载成功"),this._isBannerLoaded=!0,this._bannerAd.style.top=e-this._bannerAd.style.realHeight,this._bannerAd.style.left=(t-this._bannerAd.style.realWidth)/2}),this._bannerAd.onError(t=>{console.error("banner广告加载失败",t)})}IsBannerAvaliable(){return this._isBannerLoaded}IsVideoAvaliable(){return this._isVideoLoaded}IsInterstitalAvaliable(){return this._isInterstitialLoaded}ShowBannerAd(){this.IsBannerAvaliable()&&this._bannerAd.show()}HideBannerAd(){this.IsBannerAvaliable()&&this._bannerAd.hide()}ShowRewardVideoAd(t,e){this._isVideoLoaded?(this._rewardSuccessed=t,this._rewardSkipped=e,this._isVideoLoaded=!1,this._showVideoLoad&&this._base.showLoading({title:"正在加载视频广告",mask:!0}),Laya.stage.event(l.CommonEventId.PAUSE_AUDIO),this._showVideoLoad?this._rewardVideo.show().then(()=>{this._base.hideLoading()}):this._rewardVideo.show()):console.error("视频广告尚未加载好")}ShowInterstitalAd(){this._isInterstitialLoaded?this._intersitialAd.show():console.error("插页广告尚未加载好")}GetFromAppId(){return null==this.lauchOption.referrerInfo?null:s.default.IsNullOrEmpty(this.lauchOption.referrerInfo.appId)?null:this.lauchOption.referrerInfo.appId}_OnShow(t){console.log(n.default.platformStr,"OnShow",t),n.default.instance.lauchOption=t,n.default.instance._CheckUpdate(),n.default.instance.onResume&&n.default.instance.onResume.runWith(t)}_OnHide(t){console.log(n.default.platformStr,"OnHide",t),n.default.instance.onPause&&n.default.instance.onPause.runWith(t)}ShareAppMessage(t,e,a){console.log("分享消息",t);let s=c._WrapShareInfo(t);this._base.shareAppMessage(s),e&&e.run()}LoadSubpackage(t,e,a,s){let r={};r.name=t,r.success=(()=>{console.log("分包加载成功",t),e&&e.run()}),r.fail=(()=>{console.error("分包加载失败",t),a&&a.run()}),this._base.loadSubpackage(r).onProgressUpdate(t=>{Laya.Browser.onMobile&&console.log("分包加载进度",t),s&&s.runWith(t.progress/100)})}RecordEvent(t,e){console.log("记录事件",t,e);let a=this._base.aldSendEvent;null!=a?null!=e?a(t,e):a(t):console.error("阿拉丁sdk尚未接入,请检查配置")}StartRecord(t,e,a){if(this._isRecording)return void console.log("视频已经在录制中,不能重复录制");console.log("调用开始录屏");let s={};s.duration=o.default.Clamp(t,5,7200),this._recorderManager.start(s)}StopRecord(){this._isRecording?(console.log("调用停止录屏"),this._recorderManager.stop()):console.log("没有视频正在录制中,无法停止录制")}CreateShareVideoBtn(t,e,a,s){let r={};r.style={left:t*this._cacheScreenScale,top:e*this._cacheScreenScale,height:s*this._cacheScreenScale,width:a*this._cacheScreenScale},r.share={query:{tick:1},bgm:"",timeRange:[0,6e4]},null==this._shareVideoBtn?this._shareVideoBtn=this._base.createGameRecorderShareButton(r):this._shareVideoBtn.show()}HideShareVideoBtn(){null!=this._shareVideoBtn&&this._shareVideoBtn.hide()}ShareVideoInfo(t,e){console.log(n.default.platformStr,"不支持直接调用视频分享")}ShowToast(t){this._base.showToast({title:t,duration:2e3})}}},"./src/LTGame/Res/LTRespackManager.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return o});var s=a("./src/LTGame/Config/LoadPackConfig.ts"),r=a("./src/LTGame/LTUtils/StringEx.ts"),i=a("./src/LTGame/Platform/LTPlatform.ts"),n=a("./src/LTGame/Platform/EPlatformType.ts");class o{constructor(){this._packs=[]}static get instance(){return null==this._instance&&(this._instance=new o),this._instance}get packs(){return this._packs}get baseUrl(){return this._baseUrl}get _totalProgress(){let t=this._subpackProgress.length,e=0;for(let t of this._subpackProgress)e+=t;return e/t}SetRemoteUrl(t){if(this._baseUrl=t,r.default.IsNullOrEmpty(this._baseUrl))return;let e=null;switch(i.default.instance.platform){case n.EPlatformType.TT:case n.EPlatformType.WX:e=Laya.MiniAdpter;break;case n.EPlatformType.BD:e=Laya.BMiniAdapter;break;case n.EPlatformType.QQ:e=Laya.QQMiniAdapter}if(null!=e){Laya.URL.basePath=this._baseUrl,e.nativefiles=[];for(let t of this._packs)t.pathType!=s.EPackType.Remote&&e.nativefiles.push(t.path)}}AddPackData(...t){t.forEach(t=>{this._packs.push(t)})}LoadSubPack(t,e){this._subpackLoaded=[],this._subpackProgress=[];for(let t=0;t<this._packs.length;++t){this._packs[t].pathType==s.EPackType.SubPack&&(this._subpackLoaded.push(!1),this._subpackProgress.push(0))}let a=0;for(let r=0;r<this._packs.length;++r){let n=this._packs[r];if(n.pathType==s.EPackType.SubPack){let s=a;i.default.instance.LoadSubpackage(n.path,Laya.Handler.create(this,()=>{this._subpackLoaded[s]=!0;for(let t=0;t<this._subpackLoaded.length;++t)if(!this._subpackLoaded[t])return;t&&t.run()}),Laya.Handler.create(this,()=>{console.error("分包加载失败",n.path)}),Laya.Handler.create(this,t=>{this._subpackProgress[s]=t,e&&e.runWith(this._totalProgress)},null,!1)),a++}}0==a&&(e.runWith(1),t&&t.run())}}},"./src/LTGame/Start/LTMain.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{constructor(t){let e=new Config3D;e.octreeCulling=!1,e.enableMultiLight=!1,e.isAntialias=!0,Laya3D.init(750,1334,e,Laya.Handler.create(null,()=>{Laya.stage.scaleMode=Laya.Stage.SCALE_FIXED_WIDTH,Laya.stage.screenMode=Laya.Stage.SCREEN_VERTICAL,Laya.stage.alignV=Laya.Stage.ALIGN_MIDDLE,Laya.stage.alignH=Laya.Stage.ALIGN_CENTER,Laya.URL.exportSceneToJson=!0,Laya.alertGlobalError=!1,this._mainLogic=new t}))}}},"./src/LTGame/Start/LTSplashScene.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return c});var s=a("./src/LTGame/Fsm/BaseState.ts"),r=a("./src/LTGame/Platform/LTPlatform.ts"),i=a("./src/LTGame/UIExt/FGui/FGuiData.ts"),n=a("./src/LTGame/Res/LTRespackManager.ts"),o=a("./src/LTGame/Config/ConfigManager.ts"),l=a("./src/LTGame/UIExt/FGui/FGuiEx.ts");class c extends s.default{constructor(){super(1),this._initPath="res/fgui_load/Load",this._needLoadOtherUIPack=["res/fgui/Main"],this._loadProgressWeight=[10,1,5,2],this._configProgress=0,this._otherUIProgress=0,this._resProgress=0,this._subPackProgress=0,this._isUIShowed=!1}get _loadProgress(){let t=this._loadProgressWeight[0]+this._loadProgressWeight[1]+this._loadProgressWeight[2]+this._loadProgressWeight[3];return(this._loadProgressWeight[0]*this._subPackProgress+this._loadProgressWeight[1]*this._configProgress+this._loadProgressWeight[2]*this._resProgress+this._loadProgressWeight[3]*this._otherUIProgress)/t*100}_DoEnter(){this._InitUI()}_InitUI(){r.default.instance.RecordEvent("开始初始化启动界面",null),this._OnBindUI();let t=[];t.push({url:this._initPath+".bin",type:Laya.Loader.BUFFER}),t.push({url:this._initPath+"_atlas0.png",type:Laya.Loader.IMAGE}),Laya.loader.load(t,Laya.Handler.create(this,this._OnUILoaded))}_OnBindUI(){}_OnUILoaded(){fgui.UIPackage.addPackage(this._initPath);let t=new i.default;t.needFitScreen=!0,this._ui=l.default.AddUI(this._splashUIClass,t),this._progressUI=this._ui.m_progress,this._progressUI.value=0,this._isUIShowed=!0,r.default.instance.RecordEvent("启动界面初始化完成",null),n.default.instance.LoadSubPack(Laya.Handler.create(this,this._OnPackLoaded),Laya.Handler.create(this,this._OnPackProgress,null,!1))}_OnPackProgress(t){this._subPackProgress=t}_OnPackLoaded(){this._StartLoad()}_StartLoad(){if(r.default.instance.RecordEvent("开始加载配置表",null),this._OnSetLoadConfig(),o.ConfigManager.needLoadCount<=0)return this._configProgress=1,void this._OnConfigLoaded();o.ConfigManager.StartLoad(Laya.Handler.create(this,this._OnConfigLoaded),Laya.Handler.create(this,this._OnConfigProgress,null,!1))}_OnSetLoadConfig(){}_OnConfigProgress(t){this._configProgress=t}_OnConfigLoaded(){if(r.default.instance.RecordEvent("开始加载剩余UI资源",null),0==this._needLoadOtherUIPack.length)return void this._OnOtherUILoaded();let t=[];for(let e=0;e<this._needLoadOtherUIPack.length;++e){let a=this._needLoadOtherUIPack[e];t.push({url:a+".bin",type:Laya.Loader.BUFFER}),t.push({url:a+"_atlas0.png",type:Laya.Loader.IMAGE})}Laya.loader.load(t,Laya.Handler.create(this,this._OnOtherUILoaded),Laya.Handler.create(this,this._OnOtherUIProgress,null,!1))}_OnOtherUIProgress(t){this._otherUIProgress=t}_OnOtherUILoaded(){r.default.instance.RecordEvent("开始加载剩余游戏资源",null);for(let t=0;t<this._needLoadOtherUIPack.length;++t){let e=this._needLoadOtherUIPack[t];fgui.UIPackage.addPackage(e)}let t=[];if(this._OnGameResPrepared(t),0==t.length)return this._resProgress=1,void this._OnResLoaded();Laya.loader.create(t,Laya.Handler.create(this,this._OnResLoaded),Laya.Handler.create(this,this._OnResProgress,null,!1))}_OnGameResPrepared(t){}_OnResProgress(t){this._resProgress=t}_OnResLoaded(){this._progressUI.value=100,r.default.instance.RecordEvent("进入游戏",null),this.isFinished=!0,this._OnGameResLoaded()}_OnGameResLoaded(){}_DoRunning(){this._isUIShowed&&(this._progressUI.value=this._loadProgress)}_DoExit(){this._ui.dispose()}}},"./src/LTGame/Start/LTStart.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"LTStart",function(){return h});var s=a("./src/LTGame/Fsm/StateMachine.ts"),r=a("./src/LTGame/Platform/LTPlatform.ts"),i=a("./src/LTGame/Platform/Data/LTPlatformData.ts"),n=a("./src/LTGame/Res/LTRespackManager.ts"),o=a("./src/LTGame/Platform/EPlatformType.ts"),l=a("./src/LTGame/UIExt/FGui/FGuiEx.ts"),c=a("./src/LTGame/LTUtils/MonoHelper.ts"),d=a("./src/LTGame/LTVersion.ts");class h{constructor(){this._jsonPath="subpack.json",this.__enableStat=!1,console.log("游戏开始初始化,当前框架版本号",d.default.version),Laya.loader.load(this._jsonPath,Laya.Handler.create(this,this._OnJsonLoaded))}get _currentState(){return this._fsm.currState}get _enableStat(){return this.__enableStat}set _enableStat(t){t!=this.__enableStat&&(Laya.Stat.show(),this.__enableStat=t)}_OnJsonLoaded(){r.default.CreateInstance();let t=new i.default,e=Laya.loader.getRes(this._jsonPath);if(Laya.loader.clearRes(this._jsonPath),null!=e)for(let t=0;t<e.length;++t){let a=e[t];console.log("自动设置分包",a),n.default.instance.AddPackData(a)}this._HandleInitPlatform(r.default.instance.platform,t),this._HandleSDK(),r.default.instance.Init(t),r.default.instance.platform!=o.EPlatformType.Web&&(Laya.Shader3D.debugMode=!1),l.default.Init(r.default.instance.safeArea),Laya.timer.frameOnce(1,this,this._NextFramUpdate)}_NextFramUpdate(){this._fsm=new s.default,this._InitFsm(),0!=this._fsm.count?(this._fsm.ChangeState(1),this._RegistUpdate()):console.error("请在_InitFsm中先进行状态注册")}_RegistUpdate(){c.default.instance.AddAction(c.EActionType.Update,this,this._LogicUpdate),c.default.instance.AddAction(c.EActionType.LateUpdate,this,this._LateUpdate)}_UnRegistUpdate(){c.default.instance.RemoveAction(c.EActionType.Update,this,this._LogicUpdate),c.default.instance.RemoveAction(c.EActionType.LateUpdate,this,this._LateUpdate)}_HandleSDK(){}_HandleInitPlatform(t,e){}_LogicUpdate(){let t=Laya.timer.delta/1e3,e=this._currentState.GetNextState();if(0!=e&&!this._fsm.ChangeState(e,null))return console.error("场景切换发生错误,无法进行切换,终止游戏流程"),void this._UnRegistUpdate();this._fsm.OnRunning(null,t)}_LateUpdate(){let t=Laya.timer.delta/1e3;this._currentState.OnLateUpdate(t)}_InitFsm(){}}},"./src/LTGame/UIExt/FGui/BaseUIMediator.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{constructor(){this._scaleSmall=.8,this._tweenTime=180,this._isShow=!1,this._lockScreen=!1}get ui(){return this._ui}_InitBottom(){let t=this.ui.m_bottom_group;this._defaultBottomHeight=null==t?0:t.y}_SetBottomDown(t=0){let e=this.ui.m_bottom_group;null!=e&&(e.y=this._defaultBottomHeight+t)}_OnShow(){this._isShow=!0}Hide(t=!0){null!=this._ui&&(this._ui.isDisposed||(this._isShow=!1,this._lockScreen=!1,this._OnHide(),t?this.ui.dispose():this.ui.removeFromParent()))}_OnHide(){}}},"./src/LTGame/UIExt/FGui/FGuiData.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{constructor(){this.needFitScreen=!1}}},"./src/LTGame/UIExt/FGui/FGuiEx.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return i});var s=a("./src/LTGame/LTUtils/LTDictionary.ts"),r=a("./src/LTGame/UIExt/FGui/FGuiData.ts");class i{static Init(t=null){this.safeArea=t,fgui.UIConfig.packageFileExtension="bin",Laya.stage.addChild(fgui.GRoot.inst.displayObject),this.UpdateAllUI(),Laya.stage.on(Laya.Event.RESIZE,this,this.UpdateAllUI)}static AddUI(t,e=null){let a=t.createInstance();return fgui.GRoot.inst.addChild(a),null==e&&(e=new r.default),null!=e&&e.needFitScreen?(a.setSize(fgui.GRoot.inst.width,fgui.GRoot.inst.height-this.top-this.bottom),a.y=this.top):a.setSize(fgui.GRoot.inst.width,fgui.GRoot.inst.height),this._cacheMap.set(a.constructor.name,e),window[a.constructor.name]=a,a}static UpdateAllUI(){let t=Laya.stage.width,e=Laya.stage.height;if(null!=this.safeArea){let t=Laya.stage.width/this.safeArea.width;this.top=this.safeArea.top*t,this.bottom=this.safeArea.bottom*t}fgui.GRoot.inst.setSize(t,e);let a=fgui.GRoot.inst.numChildren;for(let t=0;t<a;++t){let e=fgui.GRoot.inst.getChildAt(t),a=this._cacheMap.Get(e.constructor.name);null!=a&&a.needFitScreen?(e.setSize(fgui.GRoot.inst.width,fgui.GRoot.inst.height-this.top-this.bottom),e.y=this.top):e.setSize(fgui.GRoot.inst.width,fgui.GRoot.inst.height)}}static CheckIn(t,e,a){return e>t.x&&e<t.x+t.width&&a>t.y&&a<t.y+t.height}static GetPointFrom3DWorld(t,e,a){let s=new Laya.Vector4;return t.worldToViewportPoint(e,s),null!=a?a.globalToLocal(s.x,s.y):new Laya.Point(s.x,s.y)}}i.top=0,i.bottom=0,i._cacheMap=new s.default},"./src/main.ts":function(t,e,a){"use strict";a.r(e);var s=a("./src/LTGame/Start/LTMain.ts"),r=a("./src/script/MainStart.ts");new s.default(r.default)},"./src/script/MainStart.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return n});var s=a("./src/LTGame/Start/LTStart.ts"),r=a("./src/script/scene/SplashScene.ts"),i=a("./src/script/scene/MainScene.ts");class n extends s.LTStart{constructor(){super(),this._enableStat=!0}_InitFsm(){this._fsm.Add(new r.default),this._fsm.Add(new i.default)}}},"./src/script/common/GameConst.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{}s.moveSpeedZ=20,s.genRoadSpeed=100,s.moveSpeedX=10,s.halfRoadWidth=3.5},"./src/script/common/GameData.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"SaveData",function(){return r}),a.d(e,"default",function(){return i});var s=a("./src/LTGame/LTUtils/StringEx.ts");class r{constructor(){this.coinCount=0,this.levelId=1}}class i{constructor(){this._savePath="game01.sav"}static get instance(){return null==this._instance&&(this._instance=new i,this._instance._ReadFromFile()),this._instance._saveData}static SaveToDisk(){if(!this._instance)return;let t=JSON.stringify(this._instance._saveData);Laya.LocalStorage.setJSON(this._instance._savePath,t)}_ReadFromFile(){let t=Laya.LocalStorage.getJSON(this._savePath);if(this._saveData=new r,!s.default.IsNullOrEmpty(t)){let e=JSON.parse(t);for(let t in e)this._saveData[t]=e[t]}console.log(this._saveData)}}},"./src/script/common/GlobalUnit.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return i});var s=a("./src/script/manager/GameManager.ts"),r=a("./src/script/manager/CameraManager.ts");class i{static InitAll(){this.s3d=Laya.stage.addChildAt(new Laya.Scene3D,0),this.gameManager=new s.default,this.cameraManager=new r.default}}},"./src/script/common/ResDefine.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s{static FixPath(t){return"res/export/Conventional/"+t+".lh"}}s.camera_path="main_camera",s.light_path="default_light",s.floor_path="follow_floor",s.player_path="player"},"./src/script/config/AudioConfig.ts":function(t,e,a){"use strict";var s;a.r(e),a.d(e,"AudioConfig",function(){return s}),function(t){t.config=class{},t.path="res/config/AudioConfig.json"}(s||(s={}))},"./src/script/config/LevelConfig.ts":function(t,e,a){"use strict";var s;a.r(e),a.d(e,"LevelConfig",function(){return s}),function(t){t.config=class{},t.path="res/config/LevelConfig.json"}(s||(s={}))},"./src/script/config/PropConfig.ts":function(t,e,a){"use strict";var s;a.r(e),a.d(e,"PropConfig",function(){return s}),function(t){t.config=class{},t.path="res/config/PropConfig.json"}(s||(s={}))},"./src/script/manager/AudioManager.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return r});var s=a("./src/script/config/AudioConfig.ts");class r{constructor(){Laya.SoundManager.autoStopMusic=!0}static get instance(){return null==this._instance&&(this._instance=new r),this._instance}PlayByPath(t){Laya.SoundManager.playMusic(t)}PlayById(t){let e=s.AudioConfig.data[t];null!=e?1==e.audio_type?Laya.SoundManager.playSound("res/audio/"+e.audio_path):this.PlayByPath("res/audio/"+e.audio_path):console.error("不存在的音效id")}StopById(t){}StopAll(){Laya.SoundManager.stopAll()}Pause(){}Resume(){}}},"./src/script/manager/CameraManager.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return l});var s=a("./src/script/common/ResDefine.ts"),r=a("./src/script/common/GlobalUnit.ts"),i=a("./src/LTGame/LTUtils/LTUtils.ts"),n=a("./src/LTGame/LTUtils/ColorEx.ts"),o=a("./src/script/common/GameConst.ts");class l{Preload(t){t.push(s.default.FixPath(s.default.camera_path))}CreateCamera(){if(null==this._cameraObj){var t=i.LTUtils.GetRes(s.default.FixPath(s.default.camera_path),!0);this._cameraObj=r.default.s3d.addChild(t),this._camera=this._cameraObj.getChildAt(0),this._camera.clearFlag=Laya.Camera.CLEARFLAG_SOLIDCOLOR,this._camera.clearColor=n.default.ToV4(n.default.HexToColor("242424")),this._camera.farPlane=200,r.default.s3d.fogColor=n.default.ToV3(n.default.HexToColor("242424")),r.default.s3d.fogStart=150,r.default.s3d.fogRange=50,r.default.s3d.enableFog=!0}this._cameraObj.transform.localPositionZ=0}LateUpdate(t){this._cameraObj.transform.localPositionZ+=t*o.default.moveSpeedZ}}},"./src/script/manager/GameManager.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return l});var s=a("./src/script/common/ResDefine.ts"),r=a("./src/script/common/GlobalUnit.ts"),i=a("./src/LTGame/LTUtils/LTUtils.ts"),n=a("./src/script/manager/RoadManager.ts"),o=a("./src/script/manager/PlayerManager.ts");class l{constructor(){this.roadManager=new n.default,this.playerManager=new o.default,this._isRunning=!1}get isRunning(){return this._isRunning}Preload(t){t.push(s.default.FixPath(s.default.light_path)),this.roadManager.Preload(t),this.playerManager.Preload(t),r.default.cameraManager.Preload(t)}CreateGame(t){r.default.s3d.addChild(i.LTUtils.GetRes(s.default.FixPath(s.default.light_path),!0)),this.playerManager.CreatePlayer(),this.roadManager.CreateRoad(t),r.default.cameraManager.CreateCamera()}StartGame(){this.roadManager.StartGame(),this._isRunning=!0}StopGame(){this.roadManager.StopGame(),this._isRunning=!1}LogicUpdate(t){this._isRunning&&(this.roadManager.LogicUpdate(t),this.playerManager.LogicUpdate(t))}LateUpdate(t){this._isRunning&&r.default.cameraManager.LateUpdate(t)}}},"./src/script/manager/PlayerManager.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return o});var s=a("./src/script/player/ModelPlayer.ts"),r=a("./src/script/common/ResDefine.ts"),i=a("./src/LTGame/LTUtils/LTUtils.ts"),n=a("./src/script/common/GlobalUnit.ts");class o{Preload(t){t.push(r.default.FixPath(r.default.player_path))}CreatePlayer(){let t=i.LTUtils.GetRes(r.default.FixPath(r.default.player_path));n.default.s3d.addChild(t),this.mainPlayer=new s.default(t)}LogicUpdate(t){this.mainPlayer.LogicUpdate(t)}}},"./src/script/manager/RoadManager.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return h});var s=a("./src/script/common/ResDefine.ts"),r=a("./src/script/common/GlobalUnit.ts"),i=a("./src/LTGame/LTUtils/LTUtils.ts"),n=a("./src/script/common/GameConst.ts"),o=a("./src/script/config/PropConfig.ts"),l=a("./src/script/config/LevelConfig.ts"),c=a("./src/script/common/GameData.ts"),d=a("./src/script/manager/AudioManager.ts");class h{Preload(t){t.push(s.default.FixPath(s.default.floor_path)),this._levelConfig=l.LevelConfig.data[c.default.instance.levelId],null==this._levelConfig&&(console.error("关卡不存在",c.default.instance.levelId,"初始化为第一关"),this._levelConfig=l.LevelConfig.dataList[0]),t.push(this._GetDataConfigPath());let e=o.PropConfig.dataList;for(let a of e)t.push(s.default.FixPath(a.model_path))}_GetDataConfigPath(){return"res/level/"+this._levelConfig.level_config}CreateRoad(t){this._followFloor=r.default.s3d.addChild(i.LTUtils.GetRes(s.default.FixPath(s.default.floor_path))),this._propContainer=new Laya.Sprite3D,r.default.s3d.addChild(this._propContainer),this._followFloor.transform.localPositionZ=0;let e=Laya.loader.getRes(this._GetDataConfigPath());this.totalDistance=e.length*n.default.genRoadSpeed;let a=e.time,l=e.data;for(let t=0;t<a.length;++t){let e=a[t]*n.default.genRoadSpeed,r=l[t];for(let t=0;t<r.length;++t){let a=r[t],l=o.PropConfig.data[a];if(null==l)continue;let c=this._propContainer.addChild(i.LTUtils.GetRes(s.default.FixPath(l.model_path)));c.transform.localPositionZ=e,c.transform.localPositionX=(2-t)*n.default.halfRoadWidth/2,c.name=""+a}}let c=e.bgm;this._cacheBgm="res/bgm/"+c+".mp3",Laya.loader.load(this._cacheBgm,t),Laya.loader.clearRes(this._GetDataConfigPath())}StartGame(){d.default.instance.PlayByPath(this._cacheBgm)}LogicUpdate(t){this._followFloor.transform.localPositionZ+=t*n.default.moveSpeedZ}StopGame(){d.default.instance.StopAll()}}},"./src/script/player/ModelPlayer.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return l});var s=a("./src/script/common/GameConst.ts"),r=a("./src/LTGame/LTUtils/MathEx.ts"),i=a("./src/script/common/GlobalUnit.ts"),n=a("./src/script/manager/AudioManager.ts"),o=a("./src/script/config/PropConfig.ts");class l{constructor(t){this.posX=0,this.posZ=0,this._lastPosX=0,this._lastPosZ=0,this._viewObj=t,this._checkFromPos=new Laya.Vector3(0,.5,0),this._checkToPos=new Laya.Vector3(0,.5,0),this._hitResults=[];let e=t.getChildAt(1),a=e.getComponent(Laya.PhysicsCollider);this._checkShape=a.colliderShape,e.active=!1}MoveX(t){i.default.gameManager.isRunning&&(this.posX=r.default.Clamp(this.posX+t*s.default.moveSpeedX,-s.default.halfRoadWidth,s.default.halfRoadWidth),this._viewObj.transform.localPositionX=this.posX)}LogicUpdate(t){this.posZ+=t*s.default.moveSpeedZ,this._viewObj.transform.localPositionZ=this.posZ,this._checkFromPos.x=this._lastPosX,this._checkFromPos.z=this._lastPosZ,this._checkToPos.x=this.posX,this._checkToPos.z=this.posZ,i.default.s3d.physicsSimulation.shapeCastAll(this._checkShape,this._checkFromPos,this._checkToPos,this._hitResults);for(let t=0;t<this._hitResults.length;++t){let e=this._hitResults[t];if(!e.succeeded)continue;let a=e.collider.owner.name;switch(a){case"1":e.collider.owner.destroy();let t=o.PropConfig.data[1];n.default.instance.PlayById(t.audio_id);break;case"2":i.default.gameManager.StopGame();break;default:console.error("暂未处理的道具类型",a)}}this._lastPosZ=this.posZ,this._lastPosX=this.posX}}},"./src/script/scene/ESceneType.ts":function(t,e,a){"use strict";var s;a.r(e),a.d(e,"ESceneType",function(){return s}),function(t){t[t.None=0]="None",t[t.Splash=1]="Splash",t[t.Main=2]="Main"}(s||(s={}))},"./src/script/scene/MainScene.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return o});var s=a("./src/LTGame/Fsm/BaseState.ts"),r=a("./src/script/scene/ESceneType.ts"),i=a("./src/script/ui/UI_MainMediator.ts"),n=a("./src/script/common/GlobalUnit.ts");class o extends s.default{constructor(){super(r.ESceneType.Main)}_DoEnter(){i.UI_MainMediator.instance.Show()}_DoRunning(){n.default.gameManager.LogicUpdate(this.deltaTime)}_DoLateUpdate(){n.default.gameManager.LateUpdate(this.deltaTime)}}},"./src/script/scene/SplashScene.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return f});var s=a("./src/ui/Load/UI_splash.ts"),r=a("./src/LTGame/Start/LTSplashScene.ts"),i=a("./src/ui/Load/LoadBinder.ts"),n=a("./src/ui/Main/MainBinder.ts"),o=a("./src/LTGame/Config/ConfigManager.ts"),l=a("./src/script/config/LevelConfig.ts"),c=a("./src/script/scene/ESceneType.ts"),d=a("./src/script/common/GlobalUnit.ts"),h=a("./src/script/config/AudioConfig.ts"),u=a("./src/script/config/PropConfig.ts");class f extends r.default{constructor(){super(),this._splashUIClass=s.default}_OnBindUI(){i.default.bindAll(),n.default.bindAll()}_OnSetLoadConfig(){o.ConfigManager.AddConfig(l.LevelConfig),o.ConfigManager.AddConfig(h.AudioConfig),o.ConfigManager.AddConfig(u.PropConfig)}_OnGameResPrepared(t){d.default.InitAll(),d.default.gameManager.Preload(t)}_OnGameResLoaded(){this.nextState=c.ESceneType.Main}}},"./src/script/ui/UI_FightMediator.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"UI_FightMediator",function(){return o});var s=a("./src/LTGame/UIExt/FGui/BaseUIMediator.ts"),r=a("./src/ui/Main/UI_Fight.ts"),i=a("./src/LTGame/UIExt/FGui/FGuiEx.ts"),n=a("./src/script/common/GlobalUnit.ts");class o extends s.default{static get instance(){return null==this._instance&&(this._instance=new o),this._instance}Show(){this._ui=i.default.AddUI(r.default),this._OnShow()}_OnShow(){super._OnShow(),this.ui.m_bg.on(Laya.Event.MOUSE_DOWN,this,this._OnMouseDown),this.ui.m_bg.on(Laya.Event.MOUSE_MOVE,this,this._OnMouseMove),Laya.stage.on(Laya.Event.MOUSE_UP,this,this._OnMouseUp),this._lastPos=new Laya.Vector2,this._isPressed=!1}_OnMouseDown(t){this._isPressed||(this._isPressed=!0,this._cacheTouchId=t.touchId,this._lastPos.x=t.stageX,this._lastPos.y=t.stageY)}_OnMouseMove(t){if(!this._isPressed)return;if(t.touchId!=this._cacheTouchId)return;let e=t.stageX-this._lastPos.x;this._lastPos.x=t.stageX;let a=-e/Laya.stage.width;n.default.gameManager.playerManager.mainPlayer.MoveX(a)}_OnMouseUp(t){this._isPressed&&t.touchId==this._cacheTouchId&&(this._isPressed=!1)}}},"./src/script/ui/UI_LoadMediator.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"UI_LoadMediator",function(){return n});var s=a("./src/LTGame/UIExt/FGui/BaseUIMediator.ts"),r=a("./src/ui/Main/UI_Load.ts"),i=a("./src/LTGame/UIExt/FGui/FGuiEx.ts");class n extends s.default{static get instance(){return null==this._instance&&(this._instance=new n),this._instance}Show(){this._ui=i.default.AddUI(r.default),this._OnShow()}_OnShow(){super._OnShow()}}},"./src/script/ui/UI_MainMediator.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"UI_MainMediator",function(){return c});var s=a("./src/LTGame/UIExt/FGui/BaseUIMediator.ts"),r=a("./src/ui/Main/UI_Main.ts"),i=a("./src/LTGame/UIExt/FGui/FGuiEx.ts"),n=a("./src/script/common/GlobalUnit.ts"),o=a("./src/script/ui/UI_FightMediator.ts"),l=a("./src/script/ui/UI_LoadMediator.ts");class c extends s.default{static get instance(){return null==this._instance&&(this._instance=new c),this._instance}Show(){this._ui=i.default.AddUI(r.default),this._OnShow()}_OnShow(){super._OnShow(),this.ui.m_btn_start.onClick(this,this._OnClickStart)}_OnClickStart(){this.Hide(),l.UI_LoadMediator.instance.Show(),n.default.gameManager.CreateGame(Laya.Handler.create(this,this._OnCreated))}_OnCreated(){l.UI_LoadMediator.instance.Hide(),o.UI_FightMediator.instance.Show(),n.default.gameManager.StartGame()}}},"./src/ui/Load/LoadBinder.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return r});var s=a("./src/ui/Load/UI_splash.ts");class r{static bindAll(){fgui.UIObjectFactory.setExtension(s.default.URL,s.default)}}},"./src/ui/Load/UI_splash.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s extends fgui.GComponent{constructor(){super()}static createInstance(){return fgui.UIPackage.createObject("Load","splash")}onConstruct(){this.m_bg=this.getChildAt(0),this.m_progress=this.getChildAt(1)}}s.URL="ui://n3oedpp6nihr0"},"./src/ui/Main/MainBinder.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return n});var s=a("./src/ui/Main/UI_Fight.ts"),r=a("./src/ui/Main/UI_Main.ts"),i=a("./src/ui/Main/UI_Load.ts");class n{static bindAll(){fgui.UIObjectFactory.setExtension(s.default.URL,s.default),fgui.UIObjectFactory.setExtension(r.default.URL,r.default),fgui.UIObjectFactory.setExtension(i.default.URL,i.default)}}},"./src/ui/Main/UI_Fight.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s extends fgui.GComponent{constructor(){super()}static createInstance(){return fgui.UIPackage.createObject("Main","Fight")}onConstruct(){this.m_bg=this.getChildAt(0),this.m_text_combo=this.getChildAt(1)}}s.URL="ui://kk7g5mmmcc4x4"},"./src/ui/Main/UI_Load.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s extends fgui.GComponent{constructor(){super()}static createInstance(){return fgui.UIPackage.createObject("Main","Load")}onConstruct(){this.m_text_str=this.getChildAt(1)}}s.URL="ui://kk7g5mmmk28i5"},"./src/ui/Main/UI_Main.ts":function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return s});class s extends fgui.GComponent{constructor(){super()}static createInstance(){return fgui.UIPackage.createObject("Main","Main")}onConstruct(){this.m_title=this.getChildAt(1),this.m_btn_start=this.getChildAt(2)}}s.URL="ui://kk7g5mmmjhmq1"}});